<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>ニュースアプリ CSVデータ仕様書（配布用）</title>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP",Helvetica,Arial;
margin:2rem;line-height:1.7}
h1,h2,h3{margin-top:1.2em}
code,pre{background:#f6f8fa;border-radius:6px;padding:.1em .35em}
table{border-collapse:collapse;width:100%;margin:1rem 0}
th,td{border:1px solid #e5e7eb;padding:8px 10px;text-align:left;vertical-align:top}
th{background:#fafafa}
.small{color:#666;font-size:.9em}
.bad{color:#b91c1c;font-weight:600}
.good{color:#166534;font-weight:600}
.toc a{text-decoration:none}
.kv{margin:.2rem 0}
.footer{margin-top:2rem;color:#666;font-size:.9em}
</style>
</head>
<body>
<h1>ニュースアプリ CSVデータ仕様書（配布用）</h1>
<p class="small">本仕様書は、インターン課題で配布する <b>CSVデータ4種</b>（users / sessions / pageviews / articles）の構造・意味・制約をまとめたものです。各CSVはUTF-8 / 1行1レコード / カンマ区切り・ヘッダありを前提とします。</p>

<h2>目次</h2>
<ul class="toc">
  <li><a href="#overview">データセット概要</a></li>
  <li><a href="#users"><code>users.csv</code> — ユーザー属性</a></li>
  <li><a href="#sessions"><code>sessions.csv</code> — セッション</a></li>
  <li><a href="#pageviews"><code>pageviews.csv</code> — ページビュー</a></li>
  <li><a href="#articles"><code>articles.csv</code> — 記事マスタ</a></li>
  <li><a href="#rules">横断ルール / 整合性制約</a></li>
  <li><a href="#format">ファイル形式 / 取り扱い注意</a></li>
</ul>

<h2 id="overview">データセット概要</h2>
<table>
  <thead><tr>
    <th>CSV名</th><th>概要</th><th>主キー</th><th>外部キー（主な参照）</th><th>備考</th>
  </tr></thead>
  <tbody>
    <tr>
      <td><code>users.csv</code></td>
      <td>ユーザー属性と登録日</td>
      <td><code>user_id</code></td>
      <td>—</td>
      <td>年代・性別はカテゴリ型</td>
    </tr>
    <tr>
      <td><code>sessions.csv</code></td>
      <td>ユーザー来訪（開始/終了/デバイス）</td>
      <td><code>session_id</code></td>
      <td><code>user_id</code> → users.user_id</td>
      <td>開始≦終了、デバイス種別あり</td>
    </tr>
    <tr>
      <td><code>pageviews.csv</code></td>
      <td>記事の閲覧イベント</td>
      <td><code>pv_id</code></td>
      <td>
        <code>user_id</code> → users.user_id、
        <code>session_id</code> → sessions.session_id、
        <code>article_id</code> → articles.article_id
      </td>
      <td>1PV=1記事読み</td>
    </tr>
    <tr>
      <td><code>articles.csv</code></td>
      <td>記事カテゴリのマスタ</td>
      <td><code>article_id</code></td>
      <td>—</td>
      <td>カテゴリ5分類</td>
    </tr>
  </tbody>
</table>

<h2 id="users"><code>users.csv</code>（ユーザー属性）</h2>
<div class="kv"><b>説明</b>：ニュースアプリのユーザー基本属性と登録日。</div>
<div class="kv"><b>期待レコード件数</b>：~10,000</div>
<table>
  <thead><tr><th>列名</th><th>型</th><th>NULL</th><th>説明</th><th>想定値 / 例</th></tr></thead>
  <tbody>
    <tr><td><code>user_id</code></td><td>string</td><td>不可</td><td>ユーザーID（主キー）</td><td>例: <code>U000123</code></td></tr>
    <tr><td><code>age_group</code></td><td>string</td><td>不可</td><td>年代</td><td><code>10-19</code>, <code>20-29</code>, <code>30-39</code>, <code>40-49</code>, <code>50-59</code>, <code>60-69</code></td></tr>
    <tr><td><code>gender</code></td><td>string</td><td>不可</td><td>性別</td><td><code>M</code> / <code>F</code></td></tr>
    <tr><td><code>signup_date</code></td><td>date (YYYY-MM-DD)</td><td>不可</td><td>登録日</td><td>範囲: 2025-06-01 ～ 2025-08-30</td></tr>
  </tbody>
</table>

<h3>整合性・ビジネスルール</h3>
<ul>
  <li><code>user_id</code> は一意。</li>
  <li><code>signup_date</code> は配布期間（2025-06-01～2025-08-30）内。</li>
</ul>

<h2 id="sessions"><code>sessions.csv</code>（セッション）</h2>
<div class="kv"><b>説明</b>：ユーザー訪問の単位。開始・終了時刻、利用デバイスを保持。</div>
<table>
  <thead><tr><th>列名</th><th>型</th><th>NULL</th><th>説明</th><th>想定値 / 例</th></tr></thead>
  <tbody>
    <tr><td><code>session_id</code></td><td>string</td><td>不可</td><td>セッションID（主キー）</td><td>例: <code>S9f1a0...</code></td></tr>
    <tr><td><code>user_id</code></td><td>string</td><td>不可</td><td>ユーザーID（FK）</td><td><code>users.user_id</code> を参照</td></tr>
    <tr><td><code>session_start</code></td><td>datetime (ISO 8601)</td><td>不可</td><td>開始日時</td><td>例: <code>2025-07-03T08:15:00</code></td></tr>
    <tr><td><code>session_end</code></td><td>datetime (ISO 8601)</td><td>不可</td><td>終了日時</td><td><code>session_end</code> ≥ <code>session_start</code></td></tr>
    <tr><td><code>device</code></td><td>string</td><td>不可</td><td>デバイス種別</td><td><code>Android</code>, <code>iOS</code>, <code>Web</code></td></tr>
  </tbody>
</table>

<h3>整合性・ビジネスルール</h3>
<ul>
  <li><code>session_id</code> は一意。</li>
  <li><code>session_end</code> は <code>session_start</code> 以上。</li>
  <li><code>user_id</code> は <code>users</code> に存在。</li>
</ul>

<h2 id="pageviews"><code>pageviews.csv</code>（ページビュー）</h2>
<div class="kv"><b>説明</b>：記事閲覧のイベント。1行=1PV。</div>
<table>
  <thead><tr><th>列名</th><th>型</th><th>NULL</th><th>説明</th><th>想定値 / 例</th></tr></thead>
  <tbody>
    <tr><td><code>pv_id</code></td><td>string</td><td>不可</td><td>ページビューID（主キー）</td><td>例: <code>PVf3a2...</code></td></tr>
    <tr><td><code>session_id</code></td><td>string</td><td>不可</td><td>セッションID（FK）</td><td><code>sessions.session_id</code> を参照</td></tr>
    <tr><td><code>user_id</code></td><td>string</td><td>不可</td><td>ユーザーID（FK）</td><td><code>users.user_id</code> を参照</td></tr>
    <tr><td><code>article_id</code></td><td>string</td><td>不可</td><td>記事ID（FK）</td><td><code>articles.article_id</code> を参照</td></tr>
    <tr><td><code>ts</code></td><td>datetime (ISO 8601)</td><td>不可</td><td>閲覧発生日時</td><td>例: <code>2025-07-21T12:34:56</code></td></tr>
  </tbody>
</table>

<h3>整合性・ビジネスルール</h3>
<ul>
  <li><code>pv_id</code> は一意。</li>
  <li><code>session_id</code> は <code>sessions</code> に存在。</li>
  <li><code>user_id</code> は <code>users</code> に存在。</li>
  <li><code>article_id</code> は <code>articles</code> に存在。</li>
  <li><code>ts</code> は <code>session_start</code>～<code>session_end</code> の範囲内であることが望ましい。</li>
</ul>

<h2 id="articles"><code>articles.csv</code>（記事マスタ）</h2>
<div class="kv"><b>説明</b>：記事IDとカテゴリ。</div>
<table>
  <thead><tr><th>列名</th><th>型</th><th>NULL</th><th>説明</th><th>想定値 / 例</th></tr></thead>
  <tbody>
    <tr><td><code>article_id</code></td><td>string</td><td>不可</td><td>記事ID（主キー）</td><td>例: <code>A001234</code></td></tr>
    <tr><td><code>category</code></td><td>string</td><td>不可</td><td>カテゴリ</td><td><code>ent</code>, <code>sports</code>, <code>economy</code>, <code>tech</code>, <code>life</code></td></tr>
  </tbody>
</table>

<h3>整合性・ビジネスルール</h3>
<ul>
  <li><code>article_id</code> は一意。</li>
  <li><code>category</code> は定義済み5値のみ。</li>
</ul>

<h2 id="rules">横断ルール / 整合性制約</h2>
<ul>
  <li><b>期間</b>：配布データの観測期間は <code>2025-06-01</code> ～ <code>2025-08-30</code>（13週）。</li>
  <li><b>イベント週</b>（キャンペーン）：<code>2025-06-21～06-27</code>、<code>2025-07-21～07-27</code>。</li>
  <li><b>主キー一意性</b>：各CSVの主キー列は重複不可。</li>
  <li><b>外部キー整合</b>：
    <ul>
      <li><code>sessions.user_id</code> ∈ <code>users.user_id</code></li>
      <li><code>pageviews.user_id</code> ∈ <code>users.user_id</code></li>
      <li><code>pageviews.session_id</code> ∈ <code>sessions.session_id</code></li>
      <li><code>pageviews.article_id</code> ∈ <code>articles.article_id</code></li>
    </ul>
  </li>
  <li><b>値の許容集合</b>：
    <ul>
      <li><code>users.gender</code> ∈ {<code>M</code>, <code>F</code>}</li>
      <li><code>users.age_group</code> ∈ {<code>10-19</code>, <code>20-29</code>, <code>30-39</code>, <code>40-49</code>, <code>50-59</code>, <code>60-69</code>}</li>
      <li><code>sessions.device</code> ∈ {<code>Android</code>, <code>iOS</code>, <code>Web</code>}</li>
      <li><code>articles.category</code> ∈ {<code>ent</code>, <code>sports</code>, <code>economy</code>, <code>tech</code>, <code>life</code>}</li>
    </ul>
  </li>
</ul>

<h2 id="format">ファイル形式 / 取り扱い注意</h2>
<ul>
  <li>文字コード：UTF-8、区切り：カンマ（<code>,</code>）、ヘッダ行あり。</li>
  <li>日付/日時の表記：<code>YYYY-MM-DD</code>、<code>YYYY-MM-DDTHH:MM:SS</code>（タイムゾーンは省略）。</li>
  <li>改行コード：<code>\n</code>（LF）。</li>
  <li>欠損値は基本発生しない設計。ただし、前処理や結合ミスで <code>NULL</code> が生じていないか確認すること。</li>
</ul>

<div class="footer">© インターン課題用データ。数値的な分布・件数は配布ロットによって微調整される場合があります。</div>
</body>
</html>
